<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="580px" preserveAspectRatio="none" style="width:1110px;height:580px;" version="1.1" viewBox="0 0 1110 580" width="1110px" zoomAndPan="magnify"><defs><filter height="300%" id="fs9kxs1zwz048" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="235" x="438.75" y="26.708">Certificate Download Flow</text><rect fill="#FFFFFF" filter="url(#fs9kxs1zwz048)" height="133.6641" style="stroke: #000000; stroke-width: 2.0;" width="934" x="165.5" y="342.1797"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="27" x2="27" y1="121.25" y2="492.8438"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="268.5" x2="268.5" y1="121.25" y2="492.8438"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="458.5" x2="458.5" y1="121.25" y2="492.8438"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="597.5" x2="597.5" y1="121.25" y2="492.8438"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="738.5" x2="738.5" y1="121.25" y2="492.8438"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="901.5" x2="901.5" y1="121.25" y2="492.8438"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1033.5" x2="1033.5" y1="121.25" y2="492.8438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="8" y="117.9482">User</text><ellipse cx="27" cy="47.9531" fill="#FEFECE" filter="url(#fs9kxs1zwz048)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M27,55.9531 L27,82.9531 M14,63.9531 L40,63.9531 M27,82.9531 L14,97.9531 M27,82.9531 L40,97.9531 " fill="none" filter="url(#fs9kxs1zwz048)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="8" y="504.8389">User</text><ellipse cx="27" cy="518.1406" fill="#FEFECE" filter="url(#fs9kxs1zwz048)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M27,526.1406 L27,553.1406 M14,534.1406 L40,534.1406 M27,553.1406 L14,568.1406 M27,553.1406 L40,568.1406 " fill="none" filter="url(#fs9kxs1zwz048)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#fs9kxs1zwz048)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="183" x="175.5" y="85.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="169" x="182.5" y="105.9482">CertificateDownloadTest</text><rect fill="#FEFECE" filter="url(#fs9kxs1zwz048)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="183" x="175.5" y="491.8438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="169" x="182.5" y="511.8389">CertificateDownloadTest</text><rect fill="#FEFECE" filter="url(#fs9kxs1zwz048)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="168" x="372.5" y="85.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="154" x="379.5" y="105.9482">JwtAssertionGenerator</text><rect fill="#FEFECE" filter="url(#fs9kxs1zwz048)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="168" x="372.5" y="491.8438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="154" x="379.5" y="511.8389">JwtAssertionGenerator</text><rect fill="#FEFECE" filter="url(#fs9kxs1zwz048)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="83" x="554.5" y="85.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="69" x="561.5" y="105.9482">GetToken</text><rect fill="#FEFECE" filter="url(#fs9kxs1zwz048)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="83" x="554.5" y="491.8438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="69" x="561.5" y="511.8389">GetToken</text><rect fill="#FEFECE" filter="url(#fs9kxs1zwz048)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="170" x="651.5" y="85.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="156" x="658.5" y="105.9482">GetCertificateFromDas</text><rect fill="#FEFECE" filter="url(#fs9kxs1zwz048)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="170" x="651.5" y="491.8438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="156" x="658.5" y="511.8389">GetCertificateFromDas</text><rect fill="#FEFECE" filter="url(#fs9kxs1zwz048)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="128" x="835.5" y="85.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="114" x="842.5" y="105.9482">WIPO OAuth2 AS</text><rect fill="#FEFECE" filter="url(#fs9kxs1zwz048)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="128" x="835.5" y="491.8438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="114" x="842.5" y="511.8389">WIPO OAuth2 AS</text><rect fill="#FEFECE" filter="url(#fs9kxs1zwz048)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="108" x="977.5" y="85.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="94" x="984.5" y="105.9482">WIPO DAS API</text><rect fill="#FEFECE" filter="url(#fs9kxs1zwz048)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="108" x="977.5" y="491.8438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="94" x="984.5" y="511.8389">WIPO DAS API</text><polygon fill="#A80036" points="257,148.3828,267,152.3828,257,156.3828,261,152.3828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="27" x2="263" y1="152.3828" y2="152.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="218" x="34" y="147.3169">Run with config + registration CSV</text><polygon fill="#A80036" points="446.5,177.5156,456.5,181.5156,446.5,185.5156,450.5,181.5156" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="269" x2="452.5" y1="181.5156" y2="181.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="276" y="176.4497">generateAssertion()</text><polygon fill="#A80036" points="280,206.6484,270,210.6484,280,214.6484,276,210.6484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="274" x2="457.5" y1="210.6484" y2="210.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="286" y="205.5825">client_assertion</text><polygon fill="#A80036" points="586,235.7813,596,239.7813,586,243.7813,590,239.7813" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="269" x2="592" y1="239.7813" y2="239.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="265" x="276" y="234.7153">getAccessToken(assertion, issuer, scope)</text><polygon fill="#A80036" points="889.5,264.9141,899.5,268.9141,889.5,272.9141,893.5,268.9141" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="598" x2="895.5" y1="268.9141" y2="268.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="605" y="263.8481">POST /access_token</text><polygon fill="#A80036" points="609,294.0469,599,298.0469,609,302.0469,605,298.0469" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="603" x2="900.5" y1="298.0469" y2="298.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="615" y="292.981">{access_token}</text><polygon fill="#A80036" points="280,323.1797,270,327.1797,280,331.1797,276,327.1797" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="274" x2="597" y1="327.1797" y2="327.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="36" x="286" y="322.1138">token</text><path d="M165.5,342.1797 L242.5,342.1797 L242.5,349.1797 L232.5,359.1797 L165.5,359.1797 L165.5,342.1797 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="133.6641" style="stroke: #000000; stroke-width: 2.0;" width="934" x="165.5" y="342.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="180.5" y="355.2466">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="286" x="257.5" y="354.3901">[for each CSV row where registered == true]</text><polygon fill="#A80036" points="726.5,376.4453,736.5,380.4453,726.5,384.4453,730.5,380.4453" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="269" x2="732.5" y1="380.4453" y2="380.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="276" y="375.3794">getCertificate()</text><polygon fill="#A80036" points="1021.5,405.5781,1031.5,409.5781,1021.5,413.5781,1025.5,409.5781" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="738.5" x2="1027.5" y1="409.5781" y2="409.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="247" x="745.5" y="404.5122">GET /requests/registrations/certificates</text><polygon fill="#A80036" points="749.5,434.7109,739.5,438.7109,749.5,442.7109,745.5,438.7109" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="743.5" x2="1032.5" y1="438.7109" y2="438.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="102" x="755.5" y="433.645">PDF bytes (200)</text><polygon fill="#A80036" points="280,463.8438,270,467.8438,280,471.8438,276,467.8438" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="274" x2="737.5" y1="467.8438" y2="467.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="286" y="462.7778">saved file</text><!--MD5=[3439413bf8ed5ff8b66fba89737e35b5]
@startuml
title Certificate Download Flow

actor User
participant "CertificateDownloadTest" as CDT
participant "JwtAssertionGenerator" as JWT
participant "GetToken" as TOK
participant "GetCertificateFromDas" as CERT
participant "WIPO OAuth2 AS" as AS
participant "WIPO DAS API" as DAS

User -> CDT: Run with config + registration CSV
CDT -> JWT: generateAssertion()
JWT - -> CDT: client_assertion
CDT -> TOK: getAccessToken(assertion, issuer, scope)
TOK -> AS: POST /access_token
AS - -> TOK: {access_token}
TOK - -> CDT: token

loop for each CSV row where registered == true
  CDT -> CERT: getCertificate()
  CERT -> DAS: GET /requests/registrations/certificates
  DAS - -> CERT: PDF bytes (200)
  CERT - -> CDT: saved file
end

@enduml

PlantUML version 1.2020.02(Sun Mar 01 11:22:07 CET 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 21.0.8+9-Ubuntu-0ubuntu122.04.1
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>